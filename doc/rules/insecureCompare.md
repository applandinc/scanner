## Description

Identifies cases in which secrets are being compared directly using `string.equals`.

## Rule logic

Every event that satisfies the following conditions is checked:

- labeled `string.equals`
- takes one argument

The rule examines both the `receiver` (aka `this / self` object) and the single `argument`. If both
values are un-bcrypted secrets, then a finding is reported.

A value is considered a secret if:

- it is generated by an event labeled `secret`
- it's a match to the list of known secret regular expressions

A value is considered bcrypted if it matches the bcrypt regular expression.

## Notes

Direct comparison of secrets using `string.equals` is insecure, because it's vulnerable to a
[timing attck](https://en.wikipedia.org/wiki/Timing_attack).

This rule can introduce a signifacnt performance penalty to the application code, because it records
every string comparison.

## Resolution

Replace direct string comparison of secrets with a secure compare function from a standard library.

## Options

None

## Examples

```yaml
- rule: insecureCompare
```
